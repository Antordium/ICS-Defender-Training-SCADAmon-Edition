<div class="content-section">
  <h2><span class="section-icon">üì°</span> Module 3: ICS Protocols Deep Dive</h2>

  <p>Welcome to Module 3, Cyber Defender! You've mastered network architecture‚Äînow it's time to understand what flows through those carefully segmented networks. Industrial protocols are the languages that PLCs, RTUs, HMIs, and SCADA systems use to communicate. Understanding these protocols is essential because <strong>most were designed decades ago without any security considerations</strong>.</p>

  <!-- Learning Objectives -->
  <div class="info-box">
    <p class="info-box-title">üéØ Learning Objectives</p>
    <ul class="content-list">
      <li>Explain how Modbus RTU and TCP function</li>
      <li>Identify DNP3's role in utilities and its security features</li>
      <li>Understand OPC UA architecture and security models</li>
      <li>Recognize protocol-specific attack vectors</li>
      <li>Implement protocol-level monitoring and defenses</li>
    </ul>
  </div>

  <!-- Video Placeholder -->
  <div class="video-container">
    <div class="video-placeholder-icon">üé¨</div>
    <div class="video-placeholder-text">Video: Speaking the Language of Machines</div>
    <div class="video-id">[V3.1 - assets/videos/m3_v1_ics_protocols_intro.mp4]</div>
  </div>

  <h3>‚ö° Modbus: The Grandfather of ICS Protocols</h3>

  <p><strong>Modbus</strong> was developed by Modicon (now Schneider Electric) in 1979, making it one of the oldest and most widely deployed industrial protocols. Its simplicity and royalty-free specification led to universal adoption across vendors and industries.</p>

  <!-- Infographic Placeholder -->
  <div class="image-container">
    <div class="image-placeholder-icon">üñºÔ∏è</div>
    <div class="image-placeholder-text">Infographic: Modbus Protocol Family</div>
    <div class="image-id">[I3.1 - assets/images/m3_i1_modbus_family.png]</div>
  </div>

  <!-- Modbus RTU Pokedex Entry -->
  <div class="pokedex-entry">
    <div class="pokedex-entry-header">
      <span class="pokedex-entry-title">Modbus RTU (Serial)</span>
      <span class="pokedex-entry-number">SERIAL</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">üìü</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Physical Layer:</span>
          <span>RS-232 or RS-485</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Format:</span>
          <span>Compact binary, CRC error check</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Architecture:</span>
          <span>Master-Slave polling on shared bus</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Use Case:</span>
          <span>Field-level devices, legacy systems</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Modbus TCP Pokedex Entry -->
  <div class="pokedex-entry">
    <div class="pokedex-entry-header">
      <span class="pokedex-entry-title">Modbus TCP (Ethernet)</span>
      <span class="pokedex-entry-number">PORT 502</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">üåê</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Transport:</span>
          <span>TCP/IP on port 502</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Header:</span>
          <span>MBAP (Modbus Application Protocol)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Pattern:</span>
          <span>Request-Response (Client-Server)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Error Check:</span>
          <span>TCP handles it (no CRC)</span>
        </div>
      </div>
    </div>
  </div>

  <h4>Modbus Function Codes</h4>
  <table class="data-table">
    <thead>
      <tr>
        <th>Code</th>
        <th>Function</th>
        <th>Description</th>
        <th>Risk Level</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>01</td>
        <td>Read Coils</td>
        <td>Read discrete outputs (ON/OFF)</td>
        <td>üü° Read</td>
      </tr>
      <tr>
        <td>02</td>
        <td>Read Discrete Inputs</td>
        <td>Read discrete inputs</td>
        <td>üü° Read</td>
      </tr>
      <tr>
        <td>03</td>
        <td>Read Holding Registers</td>
        <td>Read analog output values</td>
        <td>üü° Read</td>
      </tr>
      <tr>
        <td>04</td>
        <td>Read Input Registers</td>
        <td>Read analog input values</td>
        <td>üü° Read</td>
      </tr>
      <tr style="background: rgba(255, 28, 28, 0.15);">
        <td>05</td>
        <td>Write Single Coil</td>
        <td>Control single output</td>
        <td>üî¥ WRITE</td>
      </tr>
      <tr style="background: rgba(255, 28, 28, 0.15);">
        <td>06</td>
        <td>Write Single Register</td>
        <td>Set single value</td>
        <td>üî¥ WRITE</td>
      </tr>
      <tr style="background: rgba(255, 28, 28, 0.2);">
        <td>15</td>
        <td>Write Multiple Coils</td>
        <td>Control multiple outputs</td>
        <td>üî¥ CRITICAL</td>
      </tr>
      <tr style="background: rgba(255, 28, 28, 0.2);">
        <td>16</td>
        <td>Write Multiple Registers</td>
        <td>Set multiple values</td>
        <td>üî¥ CRITICAL</td>
      </tr>
    </tbody>
  </table>

  <div class="info-box danger">
    <p class="info-box-title">üî¥ Modbus Security Reality</p>
    <ul class="content-list">
      <li><strong>NO Authentication</strong> ‚Äî Any device on the network can read/write</li>
      <li><strong>NO Encryption</strong> ‚Äî All data travels in cleartext</li>
      <li><strong>NO Integrity Protection</strong> ‚Äî Commands can be modified in transit</li>
    </ul>
    <p>These aren't bugs‚Äîthey're features of a 1979 protocol designed for isolated serial networks!</p>
  </div>

  <h4>Modbus Attack Scenarios</h4>

  <!-- Infographic Placeholder -->
  <div class="image-container">
    <div class="image-placeholder-icon">‚öîÔ∏è</div>
    <div class="image-placeholder-text">Infographic: Modbus Attack Vectors</div>
    <div class="image-id">[I3.2 - assets/images/m3_i2_modbus_attacks.png]</div>
  </div>

  <div class="pokedex-entry" style="border-color: #FF1C1C;">
    <div class="pokedex-entry-header" style="background: linear-gradient(90deg, #FF1C1C, #8B0000);">
      <span class="pokedex-entry-title">Attack: Reconnaissance</span>
      <span class="pokedex-entry-number">RECON</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">üîç</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Method:</span>
          <span>Scan for port 502, enumerate device IDs</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Tools:</span>
          <span>Nmap Modbus scripts, Metasploit modules</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Result:</span>
          <span>PLC types, device info, register layouts</span>
        </div>
      </div>
    </div>
  </div>

  <div class="pokedex-entry" style="border-color: #FF1C1C;">
    <div class="pokedex-entry-header" style="background: linear-gradient(90deg, #FF1C1C, #8B0000);">
      <span class="pokedex-entry-title">Attack: Process Manipulation</span>
      <span class="pokedex-entry-number">CONTROL</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">üéÆ</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Method:</span>
          <span>Write arbitrary values to registers</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Example:</span>
          <span>FC 06 to address 100 = close valve</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Impact:</span>
          <span>Physical process disruption or damage</span>
        </div>
      </div>
    </div>
  </div>

  <h3>üîå DNP3: The Utility Protocol</h3>

  <!-- Video Placeholder -->
  <div class="video-container">
    <div class="video-placeholder-icon">üé¨</div>
    <div class="video-placeholder-text">Video: DNP3 in the Power Grid</div>
    <div class="video-id">[V3.2 - assets/videos/m3_v2_dnp3_utilities.mp4]</div>
  </div>

  <p><strong>Distributed Network Protocol 3 (DNP3)</strong> was developed in the 1990s for the electric utility industry and is now the dominant protocol in North American power systems, water utilities, and oil/gas pipelines.</p>

  <div class="pokedex-entry">
    <div class="pokedex-entry-header">
      <span class="pokedex-entry-title">DNP3 Protocol</span>
      <span class="pokedex-entry-number">PORT 20000</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">‚ö°</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Transport:</span>
          <span>TCP/UDP port 20000 (or serial)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Industries:</span>
          <span>Electric utilities, water, oil/gas</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Architecture:</span>
          <span>3-layer: Data Link, Transport, Application</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Security:</span>
          <span>Optional DNP3-SA (rarely enabled)</span>
        </div>
      </div>
    </div>
  </div>

  <h4>DNP3 Data Types</h4>
  <table class="data-table">
    <thead>
      <tr>
        <th>Data Type</th>
        <th>Description</th>
        <th>Example</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Binary Inputs</td>
        <td>Switch positions, alarms</td>
        <td>Breaker open/closed</td>
      </tr>
      <tr>
        <td>Binary Outputs</td>
        <td>Control commands</td>
        <td>Open/close breaker</td>
      </tr>
      <tr>
        <td>Analog Inputs</td>
        <td>Measured values</td>
        <td>Voltage, current, MW</td>
      </tr>
      <tr>
        <td>Analog Outputs</td>
        <td>Setpoints</td>
        <td>Voltage setpoint</td>
      </tr>
      <tr>
        <td>Counters</td>
        <td>Accumulated values</td>
        <td>Energy consumption (kWh)</td>
      </tr>
    </tbody>
  </table>

  <div class="pokedex-entry" style="border-color: #4CAF50; background: linear-gradient(135deg, rgba(76,175,80,0.1), rgba(76,175,80,0.05));">
    <div class="pokedex-entry-header" style="background: linear-gradient(90deg, #4CAF50, #2E7D32);">
      <span class="pokedex-entry-title">DNP3 Secure Authentication (SA)</span>
      <span class="pokedex-entry-number">IEEE 1815</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">üîê</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Authentication:</span>
          <span>Challenge-response with HMAC-SHA256</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Key Management:</span>
          <span>Session keys (manual management)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Limitation:</span>
          <span>Auth only, no encryption!</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Reality:</span>
          <span>Rarely enabled in production</span>
        </div>
      </div>
    </div>
  </div>

  <div class="info-box danger">
    <p class="info-box-title">‚ö° DNP3 in the Ukraine Attacks (2015-2016)</p>
    <p>The Ukraine power grid attacks specifically targeted DNP3 communications. Attackers used <strong>legitimate DNP3 commands</strong> to open breakers at substations after compromising HMI systems. The protocol worked exactly as designed‚Äîthe problem was attackers had unauthorized access to issue commands.</p>
    <p><strong>Key Lesson:</strong> Protocol security alone isn't enough. Access control and monitoring are critical.</p>
  </div>

  <h3>üåê OPC: From DCOM Nightmare to Modern Security</h3>

  <!-- Video Placeholder -->
  <div class="video-container">
    <div class="video-placeholder-icon">üé¨</div>
    <div class="video-placeholder-text">Video: OPC Classic vs OPC UA</div>
    <div class="video-id">[V3.3 - assets/videos/m3_v3_opc_evolution.mp4]</div>
  </div>

  <p><strong>OPC (OLE for Process Control)</strong> standardizes communication between different vendor systems. The evolution from OPC Classic to OPC UA represents a security transformation.</p>

  <div class="pokedex-entry" style="border-color: #FF8C00;">
    <div class="pokedex-entry-header" style="background: linear-gradient(90deg, #FF8C00, #CC7000);">
      <span class="pokedex-entry-title">OPC Classic (DA/HDA/A&E)</span>
      <span class="pokedex-entry-number">‚ö†Ô∏è LEGACY</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">ü™ü</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Technology:</span>
          <span>Microsoft DCOM (Windows only)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Ports:</span>
          <span>Dynamic/unpredictable (DCOM nightmare)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Security:</span>
          <span>Often disabled ("Everyone Full Control")</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Status:</span>
          <span>Legacy - migrate to OPC UA!</span>
        </div>
      </div>
    </div>
  </div>

  <div class="pokedex-entry" style="border-color: #4CAF50; background: linear-gradient(135deg, rgba(76,175,80,0.1), rgba(76,175,80,0.05));">
    <div class="pokedex-entry-header" style="background: linear-gradient(90deg, #4CAF50, #2E7D32);">
      <span class="pokedex-entry-title">OPC UA (Unified Architecture)</span>
      <span class="pokedex-entry-number">PORT 4840</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">üîí</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Platform:</span>
          <span>Cross-platform (no Windows dependency)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Transport:</span>
          <span>TCP port 4840 or HTTPS</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Authentication:</span>
          <span>Username/password, X.509 certificates</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Encryption:</span>
          <span>AES-128/256, SHA-256 signing</span>
        </div>
      </div>
    </div>
  </div>

  <div class="info-box success">
    <p class="info-box-title">üîê OPC UA Security Modes</p>
    <table class="data-table" style="margin-top: 10px;">
      <thead>
        <tr>
          <th>Mode</th>
          <th>Signing</th>
          <th>Encryption</th>
          <th>Use Case</th>
        </tr>
      </thead>
      <tbody>
        <tr style="background: rgba(255, 28, 28, 0.15);">
          <td>None</td>
          <td>‚ùå</td>
          <td>‚ùå</td>
          <td>Testing only!</td>
        </tr>
        <tr>
          <td>Sign</td>
          <td>‚úÖ</td>
          <td>‚ùå</td>
          <td>Integrity without confidentiality</td>
        </tr>
        <tr style="background: rgba(76, 175, 80, 0.15);">
          <td>SignAndEncrypt</td>
          <td>‚úÖ</td>
          <td>‚úÖ</td>
          <td>‚úÖ Production recommended</td>
        </tr>
      </tbody>
    </table>
  </div>

  <h3>üè≠ Other Industrial Protocols</h3>

  <!-- Infographic Placeholder -->
  <div class="image-container">
    <div class="image-placeholder-icon">üìä</div>
    <div class="image-placeholder-text">Infographic: ICS Protocol Landscape</div>
    <div class="image-id">[I3.3 - assets/images/m3_i3_protocol_landscape.png]</div>
  </div>

  <div class="pokedex-entry">
    <div class="pokedex-entry-header">
      <span class="pokedex-entry-title">EtherNet/IP</span>
      <span class="pokedex-entry-number">MFG</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">üè≠</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Ports:</span>
          <span>TCP 44818 (explicit), UDP 2222 (I/O)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Application:</span>
          <span>CIP (Common Industrial Protocol)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Industry:</span>
          <span>Manufacturing (North America)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Security:</span>
          <span>Optional CIP Security (limited adoption)</span>
        </div>
      </div>
    </div>
  </div>

  <div class="pokedex-entry">
    <div class="pokedex-entry-header">
      <span class="pokedex-entry-title">BACnet</span>
      <span class="pokedex-entry-number">BAS</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">üè¢</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Port:</span>
          <span>UDP 47808 (BACnet/IP)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Controls:</span>
          <span>HVAC, lighting, access, fire/life safety</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Model:</span>
          <span>Object-oriented (Analog I/O, Binary I/O)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Security:</span>
          <span>BACnet/SC (2019) - TLS over WebSockets</span>
        </div>
      </div>
    </div>
  </div>

  <div class="info-box warning">
    <p class="info-box-title">üè• BACnet in Critical Infrastructure</p>
    <p>BACnet controls HVAC in <strong>hospitals</strong>, <strong>data centers</strong>, and <strong>pharmaceutical facilities</strong> where temperature control is critical. Attackers manipulating BACnet could:</p>
    <ul class="content-list">
      <li>Cause data center overheating (equipment damage)</li>
      <li>Spoil medical supplies (patient safety)</li>
      <li>Disrupt hospital operations (life safety)</li>
    </ul>
  </div>

  <h3>üîì Common Protocol Vulnerabilities</h3>

  <!-- Video Placeholder -->
  <div class="video-container">
    <div class="video-placeholder-icon">üé¨</div>
    <div class="video-placeholder-text">Video: Exploiting ICS Protocol Weaknesses</div>
    <div class="video-id">[V3.4 - assets/videos/m3_v4_protocol_exploits.mp4]</div>
  </div>

  <table class="data-table">
    <thead>
      <tr>
        <th>Vulnerability</th>
        <th>Impact</th>
        <th>Affected Protocols</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>‚ùå <strong>No Authentication</strong></td>
        <td>Anyone can issue commands</td>
        <td>Modbus, legacy DNP3, OPC Classic, EtherNet/IP, BACnet</td>
      </tr>
      <tr>
        <td>‚ùå <strong>No Encryption</strong></td>
        <td>All data visible to attackers</td>
        <td>All legacy protocols</td>
      </tr>
      <tr>
        <td>‚ùå <strong>No Integrity</strong></td>
        <td>Commands can be modified in transit</td>
        <td>All legacy protocols</td>
      </tr>
      <tr>
        <td>‚ùå <strong>DoS Susceptibility</strong></td>
        <td>Devices crash on malformed packets</td>
        <td>All protocols (implementation bugs)</td>
      </tr>
    </tbody>
  </table>

  <h3>üî• Real-World Incident: Stuxnet Protocol Exploitation</h3>

  <div class="info-box danger">
    <p class="info-box-title">‚ò¢Ô∏è Target: Iranian Nuclear Facility (2010)</p>
    <p>Stuxnet remains the most sophisticated known ICS attack. The worm communicated with PLCs using <strong>PROFINET</strong> and <strong>S7comm</strong> protocols to:</p>
    <ul class="content-list">
      <li>Inject malicious code into PLCs controlling centrifuges</li>
      <li>Spin centrifuges at unsafe speeds while displaying normal readings</li>
      <li>Operators saw "everything normal" while equipment destroyed itself</li>
    </ul>
    <p><strong>Key Lesson:</strong> Protocol-level attacks can cause physical damage while evading detection!</p>
  </div>

  <!-- Infographic Placeholder -->
  <div class="image-container">
    <div class="image-placeholder-icon">‚ò¢Ô∏è</div>
    <div class="image-placeholder-text">Infographic: Stuxnet Attack Chain</div>
    <div class="image-id">[I3.4 - assets/images/m3_i4_stuxnet_attack.png]</div>
  </div>

  <h3>üõ°Ô∏è Protocol Security Strategies</h3>

  <div class="pokedex-entry" style="border-color: #4CAF50;">
    <div class="pokedex-entry-header" style="background: linear-gradient(90deg, #4CAF50, #2E7D32);">
      <span class="pokedex-entry-title">Defense: Network Segmentation</span>
      <span class="pokedex-entry-number">NETWORK</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">üß±</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Strategy:</span>
          <span>Limit who can reach protocol endpoints</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Implementation:</span>
          <span>Firewalls, ACLs, VLANs</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Why:</span>
          <span>If protocols can't be secured, limit access!</span>
        </div>
      </div>
    </div>
  </div>

  <div class="pokedex-entry" style="border-color: #4CAF50;">
    <div class="pokedex-entry-header" style="background: linear-gradient(90deg, #4CAF50, #2E7D32);">
      <span class="pokedex-entry-title">Defense: Protocol-Aware Firewalls</span>
      <span class="pokedex-entry-number">DPI</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">üî•</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Capability:</span>
          <span>Inspect ICS protocols at application layer</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Rules:</span>
          <span>"Only HMI-1 can write to PLC-5"</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Benefit:</span>
          <span>Compensates for lack of protocol auth</span>
        </div>
      </div>
    </div>
  </div>

  <div class="pokedex-entry" style="border-color: #4CAF50;">
    <div class="pokedex-entry-header" style="background: linear-gradient(90deg, #4CAF50, #2E7D32);">
      <span class="pokedex-entry-title">Defense: Industrial Protocol Monitoring</span>
      <span class="pokedex-entry-number">DETECT</span>
    </div>
    <div class="pokedex-entry-content">
      <div class="pokedex-entry-image">
        <span style="font-size: 3rem;">üëÅÔ∏è</span>
      </div>
      <div class="pokedex-entry-details">
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Method:</span>
          <span>Passive traffic analysis (no disruption)</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Detects:</span>
          <span>Unusual patterns, unauthorized commands, anomalies</span>
        </div>
        <div class="pokedex-stat">
          <span class="pokedex-stat-label">Products:</span>
          <span>Claroty, Dragos, Nozomi, Forescout</span>
        </div>
      </div>
    </div>
  </div>

  <h3>üìä Protocol Quick Reference</h3>

  <table class="data-table">
    <thead>
      <tr>
        <th>Protocol</th>
        <th>Port</th>
        <th>Security</th>
        <th>Secure Variant</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Modbus TCP</td>
        <td>502</td>
        <td>üî¥ None</td>
        <td>-</td>
      </tr>
      <tr>
        <td>DNP3</td>
        <td>20000</td>
        <td>üü° Optional SA</td>
        <td>DNP3-SA v5</td>
      </tr>
      <tr>
        <td>OPC UA</td>
        <td>4840</td>
        <td>üü¢ Built-in</td>
        <td>SignAndEncrypt</td>
      </tr>
      <tr>
        <td>EtherNet/IP</td>
        <td>44818/2222</td>
        <td>üü° Optional</td>
        <td>CIP Security</td>
      </tr>
      <tr>
        <td>BACnet/IP</td>
        <td>47808</td>
        <td>üü° Optional</td>
        <td>BACnet/SC</td>
      </tr>
    </tbody>
  </table>

  <h3>üõ†Ô∏è Hands-On Protocol Analysis</h3>

  <div class="info-box">
    <p class="info-box-title">üîß Essential Tools</p>
    <ul class="content-list">
      <li><strong>Wireshark</strong> ‚Äî Built-in dissectors for Modbus, DNP3, OPC UA, EtherNet/IP, BACnet</li>
      <li><strong>ModRSsim2</strong> ‚Äî Modbus simulator for safe testing</li>
      <li><strong>OpenDNP3</strong> ‚Äî DNP3 simulator and library</li>
      <li><strong>Scapy + pymodbus/pydnp3</strong> ‚Äî Python libraries for custom packet crafting</li>
    </ul>
  </div>

  <div class="info-box success">
    <p class="info-box-title">üéÆ Module Complete!</p>
    <p>Outstanding work, Cyber Defender! You now speak the languages of industrial control systems. You understand why these protocols are vulnerable and how to protect them despite their limitations. Head to <strong>Gym 3: Protocol Port</strong> to prove your knowledge against Gym Leader CIPHER!</p>
  </div>
</div>
