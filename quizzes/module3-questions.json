{
  "moduleId": "3",
  "moduleName": "ICS Protocols & Communications",
  "domain": "protocols",
  "questions": [
    {"id": "m3_q01", "type": "multiple_choice", "difficulty": 1, "question": "Which port does Modbus TCP use?", "options": ["Port 80", "Port 443", "Port 502", "Port 20000"], "correctIndex": 2, "explanation": "Modbus TCP operates on TCP port 502."},
    {"id": "m3_q02", "type": "multiple_choice", "difficulty": 2, "question": "Major security limitation of original Modbus?", "options": ["Too much bandwidth", "No authentication or encryption", "Only serial connections", "Expensive licensing"], "correctIndex": 1, "explanation": "Modbus (1979) has no authentication or encryption - anyone can send commands."},
    {"id": "m3_q03", "type": "multiple_choice", "difficulty": 2, "question": "What is DNP3 Secure Authentication?", "options": ["Separate protocol", "Enhancement adding cryptographic authentication to DNP3", "Physical security feature", "Vendor-specific"], "correctIndex": 1, "explanation": "DNP3 SA adds challenge-response authentication while maintaining compatibility."},
    {"id": "m3_q04", "type": "multiple_choice", "difficulty": 1, "question": "Which protocol uses port 20000 in utilities?", "options": ["Modbus", "BACnet", "DNP3", "OPC UA"], "correctIndex": 2, "explanation": "DNP3 (used in electric utilities) typically operates on port 20000."},
    {"id": "m3_q05", "type": "multiple_choice", "difficulty": 3, "question": "What makes OPC UA fundamentally different security-wise?", "options": ["It's faster", "Built-in security from design including encryption and certificates", "No security features", "Windows-only"], "correctIndex": 1, "explanation": "OPC UA was designed with built-in encryption, certificates, and RBAC from the start."},
    {"id": "m3_q06", "type": "true_false", "difficulty": 2, "question": "A replay attack retransmits captured legitimate messages.", "options": ["True", "False"], "correctIndex": 0, "explanation": "True. Attackers capture valid traffic and retransmit it to cause unauthorized actions."},
    {"id": "m3_q07", "type": "multiple_choice", "difficulty": 2, "question": "In Modbus, what are function codes?", "options": ["Encryption method", "Type of operation to perform (read, write)", "Authentication", "Compression"], "correctIndex": 1, "explanation": "Function codes specify operations: code 3 reads registers, code 6 writes."},
    {"id": "m3_q08", "type": "multiple_choice", "difficulty": 2, "question": "Purpose of protocol-aware firewalls in ICS?", "options": ["Increase speed", "Inspect ICS protocols and filter by specific commands", "Replace encryption", "Convert protocols"], "correctIndex": 1, "explanation": "They understand ICS protocols and can filter based on function codes."},
    {"id": "m3_q09", "type": "multiple_choice", "difficulty": 3, "question": "Man-in-the-middle on Modbus allows attacker to:", "options": ["Read only", "Intercept, modify, and forward commands", "Damage cables", "Improve reliability"], "correctIndex": 1, "explanation": "Without authentication, attackers can intercept and modify Modbus traffic."},
    {"id": "m3_q10", "type": "multiple_choice", "difficulty": 1, "question": "Protocol used in building automation (HVAC)?", "options": ["DNP3", "Modbus", "BACnet", "ICCP"], "correctIndex": 2, "explanation": "BACnet is the standard for building automation systems."},
    {"id": "m3_q11", "type": "multiple_choice", "difficulty": 2, "question": "Compensating control for legacy Modbus?", "options": ["Faster hardware", "Wrap in encrypted VPN tunnel", "Increase polling", "Add more devices"], "correctIndex": 1, "explanation": "VPN/TLS tunnels protect Modbus traffic at the network level."},
    {"id": "m3_q12", "type": "multiple_choice", "difficulty": 3, "question": "Why is encryption challenging for real-time ICS?", "options": ["Too expensive", "Overhead may cause unacceptable latency", "Already encrypted", "Illegal"], "correctIndex": 1, "explanation": "Crypto overhead can introduce latency unacceptable for time-critical control."},
    {"id": "m3_q13", "type": "true_false", "difficulty": 2, "question": "EtherNet/IP is the same as standard office Ethernet.", "options": ["True", "False"], "correctIndex": 1, "explanation": "False. EtherNet/IP adds CIP (Common Industrial Protocol) for industrial automation."},
    {"id": "m3_q14", "type": "multiple_choice", "difficulty": 1, "question": "What is serial communication in legacy ICS?", "options": ["Ethernet", "RS-232/RS-485 connections, one bit at a time", "Wireless", "Cloud-based"], "correctIndex": 1, "explanation": "Serial refers to protocols like Modbus RTU over RS-232/RS-485 connections."},
    {"id": "m3_q15", "type": "multiple_choice", "difficulty": 2, "question": "Protocol whitelisting means:", "options": ["Painting equipment", "Allow only approved protocols, block all others", "Listing in documentation", "Remove restrictions"], "correctIndex": 1, "explanation": "Only explicitly approved protocols are allowed, reducing attack surface."}
  ]
}
